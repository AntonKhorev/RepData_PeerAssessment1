---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

```{r message=FALSE}
library(dplyr)
```

## Loading and preprocessing the data

```{r}
zipFilename='activity.zip'
dataFilename='activity.csv'
if (!file.exists(dataFilename)) {
	unzip(zipFilename,dataFilename)
}
data=read.csv(dataFilename,colClasses=c('integer','Date','integer'))
data$interval=as.POSIXct(paste('2000-01-01',paste(data$interval%/%100, data$interval%%100, 0, sep=':')))
```


## What is mean total number of steps taken per day?

```{r}
stepsPerDay = (
	data %>% 
	group_by(date) %>% 
	summarize(steps=sum(steps))
)$steps
hist(stepsPerDay)
meanStepsPerDay=mean(stepsPerDay,na.rm=T)
medianStepsPerDay=median(stepsPerDay,na.rm=T)
```

Distribution of total steps per day has mean `r format(meanStepsPerDay)` and median `r format(medianStepsPerDay)`.


## What is the average daily activity pattern?

```{r}
dataIntervals = (data %>%
	group_by(interval) %>%
	summarize(steps=mean(steps,na.rm=T))
)
plot(
	dataIntervals,
	type='l',
	main='Average number of steps per interval'
)
maxStepsInterval=dataIntervals[which.max(dataIntervals$steps),]$interval
```

Maximum number of steps is between `r strftime(maxStepsInterval,format="%H:%M")` and `r strftime(maxStepsInterval+5*60,format="%H:%M")`.


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
